<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Vista de formulario para transacciones Culqi -->
    <record id="payment_transaction_form_culqi" model="ir.ui.view">
        <field name="name">payment.transaction.form.culqi</field>
        <field name="model">payment.transaction</field>
        <field name="inherit_id" ref="payment.payment_transaction_form"/>
        <field name="arch" type="xml">

            <!-- Datos principales de Culqi -->
            <xpath expr="//field[@name='provider_reference']" position="after">
                <field name="culqi_charge_id" readonly="1" invisible="provider_code != 'culqi'"/>
                <field name="culqi_token_id" readonly="1" invisible="provider_code != 'culqi'"/>
            </xpath>

            <xpath expr="//field[@name='payment_method_id']" position="after">
                <field name="culqi_payment_method" readonly="1" invisible="provider_code != 'culqi'"/>
                <field name="culqi_card_brand" readonly="1" invisible="provider_code != 'culqi'"/>
                <field name="culqi_card_last_four" readonly="1" invisible="provider_code != 'culqi'"/>

                <!-- Información agrupada -->
                <group string="Información Culqi" invisible="provider_code != 'culqi'">

                    <group string="PagoEfectivo" invisible="culqi_payment_method != 'pagoefectivo'">
                        <field name="culqi_pagoefectivo_cip" readonly="1"/>
                        <field name="culqi_pagoefectivo_expiration" readonly="1"/>
                    </group>

                    <group string="Financiamiento Cuotéalo">
                        <field name="culqi_installments" readonly="1" invisible="culqi_payment_method != 'cuotealo'"/>
                    </group>

                    <group string="Finanzas">
                        <field name="culqi_fee" readonly="1"/>
                        <field name="culqi_net_amount" readonly="1"/>
                    </group>

                    <group string="Información Técnica" groups="base.group_no_one">
                        <field name="culqi_creation_date" readonly="1"/>
                        <field name="culqi_outcome_type" readonly="1"/>
                        <field name="culqi_outcome_code" readonly="1"/>
                        <field name="culqi_email" readonly="1"/>
                        <field name="culqi_device_fingerprint" readonly="1"/>
                    </group>

                </group>
            </xpath>

            <!-- Botón a Culqi -->
            <xpath expr="//div[@name='button_box']" position="inside">
                <button name="action_view_culqi_transaction"
                        type="object"
                        class="oe_stat_button"
                        icon="fa-external-link"
                        invisible="provider_code != 'culqi'">
                    <div class="o_field_widget o_stat_info">
                        <span class="o_stat_text">Ver en Culqi</span>
                    </div>
                </button>
            </xpath>

            <!-- Recordatorio de pago -->
            <xpath expr="//field[@name='payment_id']" position="after">
                <field name="culqi_reminder_payment_id" readonly="1" invisible="provider_code != 'culqi'"/>
            </xpath>

        </field>
    </record>





</odoo>
