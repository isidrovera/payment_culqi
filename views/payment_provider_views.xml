<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- Vista de formulario para configuración de Culqi -->
    <record id="payment_provider_form_culqi" model="ir.ui.view">
        <field name="name">payment.provider.form.culqi</field>
        <field name="model">payment.provider</field>
        <field name="inherit_id" ref="payment.payment_provider_form"/>
        <field name="arch" type="xml">
            <xpath expr="//group[@name='provider_credentials']" position="after">
                <!-- Grupo de credenciales Culqi -->
                <group name="culqi_credentials" string="Culqi Credentials"
                       invisible="code != 'culqi'">
                    <field name="culqi_public_key" password="True" 
                           placeholder="pk_test_... o pk_live_..."
                           required="code == 'culqi' and state != 'disabled'"/>
                    <field name="culqi_secret_key" password="True"
                           placeholder="sk_test_... o sk_live_..."
                           required="code == 'culqi' and state != 'disabled'"/>
                    <button name="action_test_culqi_connection" 
                            string="Probar Conexión" 
                            type="object" 
                            class="btn-secondary"
                            invisible="not culqi_public_key or not culqi_secret_key"/>
                </group>
                
                <!-- Grupo de configuración Culqi -->
                <group name="culqi_configuration" string="Culqi Configuration"
                       invisible="code != 'culqi'">
                    <field name="culqi_checkout_mode"/>
                    <field name="culqi_webhook_url" readonly="1" 
                           help="URL para configurar en el panel de Culqi"/>
                </group>
                
                <!-- Métodos de pago habilitados -->
                <group name="culqi_methods" string="Métodos de Pago"
                       invisible="code != 'culqi'">
                    <field name="culqi_enable_cards"/>
                    <field name="culqi_enable_yape"/>
                    <field name="culqi_enable_pagoefectivo"/>
                    <field name="culqi_enable_cuotealo"/>
                </group>
                
                <!-- Configuración RSA (opcional) -->
                <group name="culqi_rsa" string="Encriptación RSA (Opcional)"
                       invisible="code != 'culqi'" col="1">
                    <field name="culqi_rsa_id" placeholder="ID de llave RSA"/>
                    <field name="culqi_rsa_public_key" 
                           placeholder="-----BEGIN RSA PUBLIC KEY-----"/>
                </group>
            </xpath>
        </field>
    </record>

</odoo>